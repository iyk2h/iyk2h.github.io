

### 회복

데이터베이스에 장애가 발생했을 때 데이터베이스를 일관성 있는 상태로 되돌리는 DBMS기능 으로 장애 발생시 DBMS의 회복 관리자는 트랜잭션의 ACID 성질 중 원자성과 지속성을 보장하여 장애로부터 데이터베이스를 보호한다.

원자성 - 변경 내용을 모두 반영 아니면 아예 반영하지 않는 방법과

지속성 - COMMIT하면 로그를 이용해 반드시 데이터베이스에 기록

트랜잭션은 데이터의 변경 내용을 한순간에 기록하지 않는다. 일단 변경한 내용(버퍼)을 로그(임시 디스크)에 기록 후 데이터베이스에 반영

- 시스템 충돌
	- H/W or S/W 오류로 주기억장치가 손실되는 것
- 미디어 장애
	- 헤드 충돌이나 읽기 장애로 보조기억장치가 손실되는 것
- 응용 소프트웨어 오류
	- 데이터베이스에 접근하는 S/W 논리적인 오류로 트랜잭션 수행 실패하는 것
- 자연재해
	- 화재, 홍수, 지진, 정전 등에 의한 컴퓨터 시스템 손상되는 것
- 부주의 혹은 태업
	- 운영자나 사용자의 부주의로 데이터 손실 혹은 의도적인 손상을 입는 것



### 로그파일

ACID 에서 지속성에서 사용되는 로그를 뜻하며, 트랜잭션이 반영한 모든 데이터의 변경사항을 데이터베이스에 기록하기 전에 미리 기록하는 별도의 데이터. 하드디스크에 저장된다. <트랜잭션번호, 로그 타입, 데이터 항목 이름, 수정 전 값, 수정 후 값> 형식으로 저장

### 로그 파일을 이용한 회복

#### REDO

시작과 종료가 있는 경우. (COMMIT 연산이 완료) 다만 변경 내용이 버퍼에서 데이터베이스에 기록되지 않았을 경우, 로그를 보면서 트랜잭션이 변경한 내용을 데이터베이스에 다시 기록하는 과정

#### UNDO

시작만 있고 종료가 없는 경우 (COMMIT 연산 X) 트랜잭션이 완료되지 않았기 때문에 트랜잭션이 한 일을 모두 취소
즉 버퍼에 변경 내용이 데이터베이스에 기록되어 있을 가능성이 있으므로 로그를 보면서 원상복구 시키는 과정

### 로그 파일 기록 방법

#### 즉시갱신

버퍼 -> 로그파일, 버퍼 -> 데이터베이스 작업이 부분완료 전에 동시에 진행될 수 있으며, 버퍼의 일부 내용이 실제 데이터베이스에 반영 될 수 있는 상태

- 시스템 운영 시 데이터베이스에 입출력 연산이 증가하는 단점

#### 지연갱신

버퍼 -> 로그파일 이 모두 끝난 후 부분완료를 하고 이후 버퍼 -> 데이터베이스 작업을 진행하는 방법. 부분완료 전에는 실제 데이터베이스에 반영이 되지 않는 상태

- 로그에 시작만 기록된 작업은 UNDO 작업을 할 필요가 없는 장점

- 시스템 복구 시 복구시간이 좀 더 걸리는 단점



#### 













